(this["webpackJsonpsimple-weather-app"]=this["webpackJsonpsimple-weather-app"]||[]).push([[0],{95:function(t,e,n){"use strict";n.r(e);var c=n(5),r=n(0),a=n.n(r),i=n(10),o=n.n(i),u=n(122),s=n(124),l=n(125),d=n(44),j=n(126),f=n(127),p=n(64),b=n.n(p),O=n(17),h=function(t){return function(t){return t.ui}(t).requests>0},y="INIT_APP",v="MULTI",m="API_START",x="API_END",g="ADD_CITY",E="FETCH_CURRENT_WEATHER",T="FETCH_CURRENT_WEATHER_SUCCESS",C="SET_CURRENT_WEATHER",_="DELETE_CITY",S="UPDATE_ALL_WEATHER",I="CREATE_TOAST",R="DELETE_LAST_TOAST",A=function(t,e,n){return{type:g,city:{id:"".concat(e,",").concat(n),name:t,lat:e,lng:n}}},N=function(t){return{type:E,cityId:t}},w=Object(u.a)((function(){return{root:{flexGrow:1},title:{flexGrow:1}}})),W={updateAllWeather:function(){return{type:S}}},L=Object(O.b)((function(t){return{isLoading:h(t)}}),W)((function(t){var e=t.isLoading,n=t.updateAllWeather,r=w();return Object(c.jsx)("div",{className:r.root,children:Object(c.jsx)(s.a,{position:"static",children:Object(c.jsxs)(l.a,{children:[Object(c.jsx)(d.a,{variant:"h6",className:r.title,children:"Weather"}),e?Object(c.jsx)(j.a,{color:"secondary"}):Object(c.jsx)(f.a,{color:"inherit",onClick:n,children:Object(c.jsx)(b.a,{})})]})})})})),U=n(13),H=n(16),D=n(128),k=n(129),P=n(144),q=n(130),F=n(65),J=n.n(F),B=Object(u.a)((function(t){return{appBar:{position:"relative"},title:{marginLeft:t.spacing(2),flex:1}}})),G=a.a.forwardRef((function(t,e){return Object(c.jsx)(D.a,Object(H.a)({direction:"up",ref:e},t))})),M=function(t){var e=t.title,n=t.open,r=t.onClose,a=t.children,i=B(),o=Object(k.a)("(max-width: 769px)");return Object(c.jsxs)(P.a,{open:n,fullScreen:o,fullWidth:!0,onClose:r,TransitionComponent:G,children:[Object(c.jsx)(s.a,{className:i.appBar,children:Object(c.jsxs)(l.a,{children:[Object(c.jsx)(f.a,{edge:"start",color:"inherit",onClick:r,"aria-label":"close",children:Object(c.jsx)(J.a,{})}),Object(c.jsx)(d.a,{variant:"h6",className:i.title,children:e})]})}),Object(c.jsx)(q.a,{children:a})]})},z=n(141),X=n(133),Y=n(132),V=n(134),K=n(66),Q=n.n(K),Z=Object(u.a)((function(){return{root:{height:"60vh"}}})),$={addCity:A},tt=Object(O.b)(void 0,$)((function(t){var e=t.addCity,n=Z(),a=Object(r.useState)(""),i=Object(U.a)(a,2),o=i[0],u=i[1],s=Object(r.useState)([]),l=Object(U.a)(s,2),d=l[0],j=l[1];Object(r.useEffect)((function(){fetch("cities.json").then((function(t){return t.json()})).then((function(t){return t.map((function(t,e){return{id:e,name:t[0],country:t[1],lat:t[2],lng:t[3]}}))})).then(j)}),[]);var f=d.filter((function(t){return t.name.toUpperCase().includes(o.toUpperCase())})).slice(0,25),p=0===f.length?"Not found":f.length<25?"":"...";return Object(c.jsxs)("div",{className:n.root,children:[Object(c.jsx)(z.a,{value:o,onChange:function(t){u(t.target.value)},fullWidth:!0,autoFocus:!0,margin:"normal",InputProps:{startAdornment:Object(c.jsx)(X.a,{position:"start",children:Object(c.jsx)(Q.a,{})})}}),Object(c.jsxs)(Y.a,{children:[f.map((function(t){return Object(c.jsx)(V.a,{onClick:(n=t.id,function(){var t=d[n];e(t.name,t.lat,t.lng)}),button:!0,children:"".concat(t.name,", ").concat(t.country)},t.id);var n})),Object(c.jsx)(V.a,{children:p})]})]})})),et=n(135),nt=n(67),ct=n.n(nt),rt=Object(u.a)((function(t){return{button:{position:"absolute",right:t.spacing(3),bottom:t.spacing(3)}}})),at=function(){var t=rt(),e=Object(r.useState)(!1),n=Object(U.a)(e,2),a=n[0],i=n[1];return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(et.a,{onClick:function(){i(!0)},color:"primary","aria-label":"add",className:t.button,children:Object(c.jsx)(ct.a,{})}),Object(c.jsx)(M,{title:"Choose city",open:a,onClose:function(){i(!1)},children:Object(c.jsx)(tt,{})})]})},it=n(142),ot=n(139),ut=function(t){return t.cities},st=function(t){return Object.keys(ut(t))},lt=function(t,e){return ut(t)[e]},dt=n(136),jt=n(137),ft=n(138),pt=n(68),bt=n.n(pt),Ot=Object(u.a)((function(t){return{current:{textAlign:"center",fontSize:"2em",marginBottom:t.spacing(1)}}})),ht={deleteCity:function(t){return{type:_,cityId:t}}},yt=Object(O.b)((function(t,e){var n=e.id;return{city:lt(t,n)}}),ht)((function(t){var e,n,r=t.city,a=t.deleteCity,i=Ot();return Object(c.jsxs)(dt.a,{children:[Object(c.jsx)(jt.a,{title:r.name,action:Object(c.jsx)(f.a,{"aria-label":"delete-city",onClick:function(){return a(r.id)},children:Object(c.jsx)(bt.a,{})})}),Object(c.jsx)(ft.a,{children:r.currentWeather?Object(c.jsxs)("div",{children:[Object(c.jsx)("div",{className:i.current,children:null===(e=r.currentWeather)||void 0===e?void 0:e.temperature}),Object(c.jsx)(ot.a,{container:!0,spacing:2,justify:"center",children:null===(n=r.forecast)||void 0===n?void 0:n.slice(1,6).map((function(t,e){return Object(c.jsxs)(ot.a,{item:!0,children:[Object(c.jsx)("div",{children:"Today"}),Object(c.jsx)("div",{children:t.temperature})]})}))})]}):"Loading"})]})})),vt=Object(O.b)((function(t){return{citiesIds:st(t)}}))((function(t){var e=t.citiesIds;return Object(c.jsx)(it.a,{m:4,children:Object(c.jsx)(ot.a,{container:!0,spacing:2,children:e.map((function(t){return Object(c.jsx)(ot.a,{item:!0,xs:12,md:4,children:Object(c.jsx)(yt,{id:t})},t)}))})})})),mt=n(145),xt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;return{type:I,toast:{message:t,timeout:e}}},gt=function(t){var e=function(t){return t.toasts}(t);return e.length?e[0]:null},Et={deleteLastToast:function(){return{type:R}}},Tt=Object(O.b)((function(t){return{toast:gt(t)}}),Et)((function(t){var e=t.toast,n=t.deleteLastToast,a=Object(r.useState)(!1),i=Object(U.a)(a,2),o=i[0],u=i[1];return Object(r.useEffect)((function(){u(null!==e)}),[e]),Object(c.jsx)(mt.a,{message:null===e||void 0===e?void 0:e.message,open:o,onClose:function(){u(!1)},anchorOrigin:{vertical:"bottom",horizontal:"left"},autoHideDuration:null===e||void 0===e?void 0:e.timeout,onExited:function(){return n()}})}));var Ct={initApp:function(){return{type:y}}},_t=Object(O.b)(void 0,Ct)((function(t){var e=t.initApp;return Object(r.useEffect)((function(){e()}),[e]),Object(c.jsxs)("div",{children:[Object(c.jsx)(L,{}),Object(c.jsx)(vt,{}),Object(c.jsx)(at,{}),Object(c.jsx)(Tt,{})]})})),St=(n(94),n(140)),It=n(18),Rt=n(26),At=n(11),Nt={},wt=[],Wt={requests:0},Lt=Object(Rt.c)({cities:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Nt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case g:var n=e.city;return Object(H.a)(Object(H.a)({},t),{},Object(At.a)({},n.id,n));case C:var c=e.payload,r=c.cityId,a=c.weather,i=c.forecast;return Object(H.a)(Object(H.a)({},t),{},Object(At.a)({},r,Object(H.a)(Object(H.a)({},t[r]),{},{currentWeather:a,forecast:i})));case _:var o=e.cityId,u=Object(H.a)({},t);return delete u[o],u;default:return t}},ui:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case m:return Object(H.a)(Object(H.a)({},t),{},{requests:t.requests+1});case x:return Object(H.a)(Object(H.a)({},t),{},{requests:t.requests-1});default:return t}},toasts:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case I:return[].concat(Object(It.a)(t),[e.toast]);case R:return t.slice(1);default:return t}}}),Ut=function(t,e,n,c){return{type:m,payload:{url:t,method:"GET",pending:e,success:n,error:c}}},Ht=function(t){return{type:v,actions:t}},Dt=[function(t){var e=t.dispatch;return function(t){return function(n){t(n),n.type===v&&n.actions.forEach((function(t){return e(t)}))}}},function(t){var e=t.dispatch;return function(t){return function(n){if(t(n),n.type===m){var c=n.payload,r=c.method,a=c.pending,i=c.success,o=c.error,u=c.data,s=c.url,l=n.payload,d={method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(u)||void 0};e(a),fetch(encodeURI("https://cors-anywhere.herokuapp.com/http://api.openweathermap.org/data/2.5"+s+"&units=metric&appid=5d2145b1e3153ce2a87bbad571a98ba4"),d).then((function(t){return t.json()})).then((function(t){l.success.payload.data=t,e(i)})).catch((function(t){o.payload.data=t,e(o)})).then((function(){return e({type:x})}))}}}},function(t){var e=t.dispatch;return function(t){return function(n){t(n),n.type===y&&navigator.geolocation.getCurrentPosition((function(t){var n=t.coords,c=n.latitude,r=n.longitude;e(A("Current",c,r))}),(function(){e(xt("Could not access current location"))}))}}},function(t){var e=t.dispatch,n=t.getState;return function(t){return function(c){if(c.type===g&&6===st(n()).length)return void e(xt("Only 6 cities allowed"));t(c)}}},function(t){var e=t.dispatch,n=t.getState;return function(t){return function(c){if(t(c),c.type===y){var r=JSON.parse(localStorage.getItem("cities"));r&&e(Ht(r.map((function(t){return A(t.name,t.lat,t.lng)}))))}if(c.type===g){var a=Object.values(n().cities).filter((function(t){return"Current"!==t.name}));localStorage.setItem("cities",JSON.stringify(a))}}}},function(t){var e=t.dispatch,n=t.getState;return function(t){return function(c){if(t(c),c.type===g&&e(N(c.city.id)),c.type===E){var r=c.cityId,a={type:"FETCH_CURRENT_WEATHER_PENDING",id:r},i=function(t){return{type:T,cityId:t,payload:{data:void 0}}}(r),o=function(t){return{type:"FETCH_CURRENT_WEATHER_ERROR",cityId:t,payload:{data:void 0}}}(r),u=r.split(","),s=Object(U.a)(u,2),l=s[0],d=s[1];e(Ut("/onecall?lat=".concat(l,"&lon=").concat(d,"&exclude=minutely,hourly,alerts"),a,i,o))}if(c.type===T){var j=c.cityId,f=c.payload.data,p={temperature:f.current.temp},b=f.daily.map((function(t){return{temperature:t.temp.day}}));lt(n(),j)&&e(function(t,e,n){return{type:C,payload:{cityId:t,weather:e,forecast:n}}}(j,p,b))}}}},function(t){var e=t.dispatch,n=t.getState;return function(t){return function(c){t(c),c.type===S&&e(Ht(st(n()).map((function(t){return N(t)}))))}}}],kt=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Rt.d,Pt=Object(Rt.e)(Lt,kt(Rt.a.apply(void 0,Object(It.a)(Dt))));o.a.render(Object(c.jsxs)(a.a.StrictMode,{children:[Object(c.jsx)(St.a,{}),Object(c.jsx)(O.a,{store:Pt,children:Object(c.jsx)(_t,{})})]}),document.getElementById("root"))}},[[95,1,2]]]);
//# sourceMappingURL=main.c71cd458.chunk.js.map