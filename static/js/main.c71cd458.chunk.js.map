{"version":3,"sources":["app/selectors/ui.ts","app/constants/actions.ts","app/actions/cities.ts","components/Header/index.tsx","components/AddCity/AddCityWindow.tsx","components/AddCity/Body.tsx","components/AddCity/fetchDependencies.ts","components/AddCity/index.tsx","app/selectors/cities.ts","components/Main/CityCard.tsx","components/Main/index.tsx","app/actions/toasts.ts","app/selectors/toasts.ts","components/Toaster.tsx","App.tsx","app/actions/initApp.ts","app/reducers/cities.ts","app/reducers/toaster.ts","app/reducers/ui.ts","app/reducers/root.ts","app/actions/api.ts","app/actions/multi.ts","app/middleware/index.ts","app/middleware/core/multi.ts","app/middleware/core/api.ts","app/constants/urls.ts","app/middleware/app/initApp.ts","app/middleware/app/limitNumberOfCities.ts","app/middleware/app/persistance.ts","app/middleware/app/fetchWeather.ts","app/middleware/app/updateWeather.ts","app/store.ts","index.tsx"],"names":["getIsLoading","state","ui","getUiSlice","requests","INIT_APP","MULTI","API_START","API_END","ADD_CITY","FETCH_CURRENT_WEATHER","FETCH_CURRENT_WEATHER_SUCCESS","SET_CURRENT_WEATHER","DELETE_CITY","UPDATE_ALL_WEATHER","CREATE_TOAST","DELETE_LAST_TOAST","addCity","name","lat","lng","type","city","id","fetchCityCurrentWeather","cityId","useStyles","makeStyles","root","flexGrow","title","mapDispatchToProps","updateAllWeather","connect","isLoading","classes","className","AppBar","position","Toolbar","Typography","variant","CircularProgress","color","IconButton","onClick","theme","appBar","marginLeft","spacing","flex","Transition","React","forwardRef","props","ref","Slide","direction","AddCityWindow","open","onClose","children","isMobile","useMediaQuery","Dialog","fullScreen","fullWidth","TransitionComponent","edge","aria-label","DialogContent","height","mapDisptachToProps","undefined","useState","search","setSearch","cities","setCities","useEffect","fetch","then","response","json","cities_data","map","c","index","country","list","filter","toUpperCase","includes","slice","lastItemText","length","TextField","value","onChange","evt","target","autoFocus","margin","InputProps","startAdornment","InputAdornment","List","ListItem","button","right","bottom","AddCity","setOpen","Fab","getCitiesSlice","getCitiesIds","Object","keys","getCityById","current","textAlign","fontSize","marginBottom","deleteCity","Card","CardHeader","action","CardContent","currentWeather","temperature","Grid","container","justify","forecast","f","i","item","citiesIds","Box","m","xs","md","createToast","message","timeout","toast","getToastMessage","toasts","getToastsSlice","deleteLastToast","isOpen","setIsOpen","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","onExited","initApp","initialState","rootReducer","combineReducers","payload","weather","newState","api","url","pending","success","error","method","multi","actions","middleware","dispatch","next","forEach","a","data","options","headers","body","JSON","stringify","encodeURI","catch","err","navigator","geolocation","getCurrentPosition","coords","latitude","longitude","getState","parse","localStorage","getItem","persistableCities","values","setItem","fetchCityCurrentWeatherSuccess","fetchCityCurrentWeatherError","split","lon","temp","daily","day","setCityCurrentWeather","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","createStore","applyMiddleware","ReactDOM","render","StrictMode","CssBaseline","store","document","getElementById"],"mappings":"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","file":"static/js/main.c71cd458.chunk.js","sourcesContent":["import { AppState } from \"app/types/AppState\";\r\n\r\nconst getUiSlice = (state: AppState) => state.ui;\r\n\r\nexport const getIsLoading = (state: AppState) => getUiSlice(state).requests > 0;\r\n","export const INIT_APP = \"INIT_APP\";\r\n\r\n// Multi Middleware\r\nexport const MULTI = \"MULTI\";\r\n\r\n// Api middleware\r\nexport const API_START = \"API_START\";\r\nexport const API_END = \"API_END\";\r\n\r\n// City constants\r\nexport const ADD_CITY = \"ADD_CITY\";\r\nexport const FETCH_CURRENT_WEATHER = \"FETCH_CURRENT_WEATHER\";\r\nexport const FETCH_CURRENT_WEATHER_PENDING = \"FETCH_CURRENT_WEATHER_PENDING\";\r\nexport const FETCH_CURRENT_WEATHER_SUCCESS = \"FETCH_CURRENT_WEATHER_SUCCESS\";\r\nexport const FETCH_CURRENT_WEATHER_ERROR = \"FETCH_CURRENT_WEATHER_ERROR\";\r\nexport const SET_CURRENT_WEATHER = \"SET_CURRENT_WEATHER\";\r\nexport const DELETE_CITY = \"DELETE_CITY\";\r\nexport const UPDATE_ALL_WEATHER = \"UPDATE_ALL_WEATHER\";\r\n\r\n// Toasts\r\nexport const CREATE_TOAST = \"CREATE_TOAST\";\r\nexport const DELETE_LAST_TOAST = \"DELETE_LAST_TOAST\";\r\n","import {\r\n  ADD_CITY,\r\n  SET_CURRENT_WEATHER,\r\n  FETCH_CURRENT_WEATHER,\r\n  FETCH_CURRENT_WEATHER_PENDING,\r\n  FETCH_CURRENT_WEATHER_SUCCESS,\r\n  FETCH_CURRENT_WEATHER_ERROR,\r\n  DELETE_CITY,\r\n  UPDATE_ALL_WEATHER,\r\n} from \"app/constants/actions\";\r\nimport { City } from \"app/types/City\";\r\nimport { OpOneCall } from \"app/types/op/types\";\r\nimport { Weather } from \"app/types/Weather\";\r\n\r\nexport interface AddCity {\r\n  type: typeof ADD_CITY;\r\n  city: City;\r\n}\r\n\r\nexport const addCity = (name: string, lat: number, lng: number): AddCity => ({\r\n  type: ADD_CITY,\r\n  city: { id: `${lat},${lng}`, name, lat, lng },\r\n});\r\n\r\nexport interface SetCityCurrentWeather {\r\n  type: typeof SET_CURRENT_WEATHER;\r\n  payload: {\r\n    cityId: string;\r\n    weather: Weather;\r\n    forecast: Weather[];\r\n  };\r\n}\r\n\r\nexport const setCityCurrentWeather = (\r\n  cityId: string,\r\n  weather: Weather,\r\n  forecast: Weather[]\r\n): SetCityCurrentWeather => ({\r\n  type: SET_CURRENT_WEATHER,\r\n  payload: {\r\n    cityId,\r\n    weather,\r\n    forecast,\r\n  },\r\n});\r\n\r\ninterface FetchCityCurrentWeather {\r\n  type: typeof FETCH_CURRENT_WEATHER;\r\n  cityId: string;\r\n}\r\n\r\nexport const fetchCityCurrentWeather = (\r\n  cityId: string\r\n): FetchCityCurrentWeather => ({\r\n  type: FETCH_CURRENT_WEATHER,\r\n  cityId,\r\n});\r\n\r\ninterface FetchCityCurrentWeatherPending {\r\n  type: typeof FETCH_CURRENT_WEATHER_PENDING;\r\n  id: string;\r\n}\r\n\r\nexport const fetchCityCurrentWeatherPending = (\r\n  id: string\r\n): FetchCityCurrentWeatherPending => ({\r\n  type: FETCH_CURRENT_WEATHER_PENDING,\r\n  id,\r\n});\r\n\r\ninterface FetchCityCurrentWeatherSuccess {\r\n  type: typeof FETCH_CURRENT_WEATHER_SUCCESS;\r\n  cityId: string;\r\n  payload: {\r\n    data?: OpOneCall;\r\n  };\r\n}\r\nexport const fetchCityCurrentWeatherSuccess = (\r\n  cityId: string\r\n): FetchCityCurrentWeatherSuccess => ({\r\n  type: FETCH_CURRENT_WEATHER_SUCCESS,\r\n  cityId,\r\n  payload: {\r\n    data: undefined,\r\n  },\r\n});\r\n\r\ninterface FetchCityCurrentWeatherError {\r\n  type: typeof FETCH_CURRENT_WEATHER_ERROR;\r\n  cityId: string;\r\n  payload: {\r\n    data: any;\r\n  };\r\n}\r\n\r\nexport const fetchCityCurrentWeatherError = (\r\n  cityId: string\r\n): FetchCityCurrentWeatherError => ({\r\n  type: FETCH_CURRENT_WEATHER_ERROR,\r\n  cityId,\r\n  payload: {\r\n    data: undefined,\r\n  },\r\n});\r\n\r\ninterface DeleteCity {\r\n  type: typeof DELETE_CITY;\r\n  cityId: string;\r\n}\r\n\r\nexport const deleteCity = (cityId: string): DeleteCity => ({\r\n  type: DELETE_CITY,\r\n  cityId,\r\n});\r\n\r\ninterface UpdateAllWeather {\r\n  type: typeof UPDATE_ALL_WEATHER;\r\n}\r\n\r\nexport const updateAllWeather = (): UpdateAllWeather => ({\r\n  type: UPDATE_ALL_WEATHER,\r\n});\r\n\r\nexport type CityActions =\r\n  | AddCity\r\n  | SetCityCurrentWeather\r\n  | FetchCityCurrentWeather\r\n  | FetchCityCurrentWeatherPending\r\n  | FetchCityCurrentWeatherSuccess\r\n  | FetchCityCurrentWeatherError\r\n  | UpdateAllWeather\r\n  | DeleteCity;\r\n","import React from \"react\";\r\nimport {\r\n  AppBar,\r\n  Toolbar,\r\n  Typography,\r\n  makeStyles,\r\n  IconButton,\r\n  CircularProgress,\r\n} from \"@material-ui/core\";\r\nimport RefreshIcon from \"@material-ui/icons/Refresh\";\r\nimport { connect } from \"react-redux\";\r\nimport { getIsLoading } from \"app/selectors/ui\";\r\nimport { AppState } from \"app/types/AppState\";\r\nimport { updateAllWeather } from \"app/actions/cities\";\r\n\r\nconst useStyles = makeStyles(() => ({\r\n  root: {\r\n    flexGrow: 1,\r\n  },\r\n  title: {\r\n    flexGrow: 1,\r\n  },\r\n}));\r\n\r\ninterface Props {\r\n  isLoading: boolean;\r\n  updateAllWeather: typeof updateAllWeather;\r\n}\r\n\r\nconst Header = ({ isLoading, updateAllWeather }: Props) => {\r\n  const classes = useStyles();\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <AppBar position=\"static\">\r\n        <Toolbar>\r\n          <Typography variant=\"h6\" className={classes.title}>\r\n            Weather\r\n          </Typography>\r\n          {isLoading ? (\r\n            <CircularProgress color=\"secondary\" />\r\n          ) : (\r\n            <IconButton color=\"inherit\" onClick={updateAllWeather}>\r\n              <RefreshIcon />\r\n            </IconButton>\r\n          )}\r\n        </Toolbar>\r\n      </AppBar>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state: AppState) => ({\r\n  isLoading: getIsLoading(state),\r\n});\r\n\r\nconst mapDispatchToProps = { updateAllWeather };\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Header);\r\n","import React, { FC } from \"react\";\r\nimport {\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  IconButton,\r\n  Typography,\r\n  AppBar,\r\n  makeStyles,\r\n  Slide,\r\n  Toolbar,\r\n  useMediaQuery,\r\n} from \"@material-ui/core\";\r\nimport CloseIcon from \"@material-ui/icons/Close\";\r\n\r\ninterface Props {\r\n  title: string;\r\n  open: boolean;\r\n  onClose: () => void;\r\n}\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  appBar: {\r\n    position: \"relative\",\r\n  },\r\n  title: {\r\n    marginLeft: theme.spacing(2),\r\n    flex: 1,\r\n  },\r\n}));\r\n\r\nconst Transition = React.forwardRef(function Transition(props, ref) {\r\n  //@ts-ignore\r\n  return <Slide direction=\"up\" ref={ref} {...props} />;\r\n});\r\n\r\nexport const AddCityWindow: FC<Props> = ({\r\n  title,\r\n  open,\r\n  onClose,\r\n  children,\r\n}) => {\r\n  const classes = useStyles();\r\n  const isMobile = useMediaQuery(\"(max-width: 769px)\");\r\n\r\n  return (\r\n    <Dialog\r\n      open={open}\r\n      fullScreen={isMobile}\r\n      fullWidth={true}\r\n      onClose={onClose}\r\n      TransitionComponent={Transition as any}\r\n    >\r\n      <AppBar className={classes.appBar}>\r\n        <Toolbar>\r\n          <IconButton\r\n            edge=\"start\"\r\n            color=\"inherit\"\r\n            onClick={onClose}\r\n            aria-label=\"close\"\r\n          >\r\n            <CloseIcon />\r\n          </IconButton>\r\n          <Typography variant=\"h6\" className={classes.title}>\r\n            {title}\r\n          </Typography>\r\n        </Toolbar>\r\n      </AppBar>\r\n      <DialogContent>{children}</DialogContent>\r\n    </Dialog>\r\n  );\r\n};\r\n","import React, { useState, ChangeEvent, useEffect } from \"react\";\r\nimport {\r\n  TextField,\r\n  List,\r\n  ListItem,\r\n  makeStyles,\r\n  InputAdornment,\r\n} from \"@material-ui/core\";\r\nimport { CityDto, fetchDependencies } from \"./fetchDependencies\";\r\nimport SearchIcon from \"@material-ui/icons/Search\";\r\nimport { connect } from \"react-redux\";\r\nimport { addCity } from \"app/actions/cities\";\r\nconst useStyles = makeStyles(() => ({\r\n  root: {\r\n    height: \"60vh\",\r\n  },\r\n}));\r\n\r\ninterface Props {\r\n  addCity: typeof addCity;\r\n}\r\n\r\nconst Body = ({ addCity }: Props) => {\r\n  const classes = useStyles();\r\n  const [search, setSearch] = useState(\"\");\r\n\r\n  const [cities, setCities] = useState<CityDto[]>([]);\r\n\r\n  const handleOnChange = (\r\n    evt: ChangeEvent<HTMLTextAreaElement | HTMLInputElement>\r\n  ) => {\r\n    setSearch(evt.target.value);\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchDependencies().then(setCities);\r\n  }, []);\r\n\r\n  const maxNumberDisplayed = 25;\r\n  const list = cities\r\n    .filter((c) => c.name.toUpperCase().includes(search.toUpperCase()))\r\n    .slice(0, maxNumberDisplayed);\r\n\r\n  const lastItemText =\r\n    list.length === 0\r\n      ? \"Not found\"\r\n      : list.length < maxNumberDisplayed\r\n      ? \"\"\r\n      : \"...\";\r\n\r\n  const handleAdd = (id: number) => () => {\r\n    const city = cities[id];\r\n    addCity(city.name, city.lat, city.lng);\r\n  };\r\n\r\n  return (\r\n    <div className={classes.root}>\r\n      <TextField\r\n        value={search}\r\n        onChange={handleOnChange}\r\n        fullWidth\r\n        autoFocus\r\n        margin=\"normal\"\r\n        InputProps={{\r\n          startAdornment: (\r\n            <InputAdornment position=\"start\">\r\n              <SearchIcon />\r\n            </InputAdornment>\r\n          ),\r\n        }}\r\n      />\r\n\r\n      <List>\r\n        {list.map((c) => (\r\n          <ListItem\r\n            key={c.id}\r\n            onClick={handleAdd(c.id)}\r\n            button\r\n          >{`${c.name}, ${c.country}`}</ListItem>\r\n        ))}\r\n        <ListItem>{lastItemText}</ListItem>\r\n      </List>\r\n    </div>\r\n  );\r\n};\r\n\r\nconst mapDisptachToProps = {\r\n  addCity,\r\n};\r\n\r\nexport default connect(undefined, mapDisptachToProps)(Body);\r\n","type DataTuple = [string, string, number, number];\r\n\r\nexport interface CityDto {\r\n  id: number;\r\n  name: string;\r\n  country: string;\r\n  lat: number;\r\n  lng: number;\r\n}\r\n\r\nexport const fetchDependencies = () => {\r\n  return fetch(\"cities.json\")\r\n    .then((response) => response.json())\r\n    .then((cities_data: DataTuple[]) => {\r\n      const cities: CityDto[] = (cities_data as DataTuple[]).map(\r\n        (c, index) => ({\r\n          id: index,\r\n          name: c[0],\r\n          country: c[1],\r\n          lat: c[2],\r\n          lng: c[3],\r\n        })\r\n      );\r\n      return cities;\r\n    });\r\n};\r\n","import React, { useState } from \"react\";\r\nimport { AddCityWindow } from \"./AddCityWindow\";\r\nimport Body from \"./Body\";\r\nimport { Fab, makeStyles } from \"@material-ui/core\";\r\nimport AddIcon from \"@material-ui/icons/Add\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    position: \"absolute\",\r\n    right: theme.spacing(3),\r\n    bottom: theme.spacing(3),\r\n  },\r\n}));\r\n\r\nexport const AddCity = () => {\r\n  const classes = useStyles();\r\n  const [open, setOpen] = useState(false);\r\n\r\n  const handleOpen = () => {\r\n    setOpen(true);\r\n  };\r\n\r\n  const handleClose = () => {\r\n    setOpen(false);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <Fab\r\n        onClick={handleOpen}\r\n        color=\"primary\"\r\n        aria-label=\"add\"\r\n        className={classes.button}\r\n      >\r\n        <AddIcon />\r\n      </Fab>\r\n      <AddCityWindow title=\"Choose city\" open={open} onClose={handleClose}>\r\n        <Body />\r\n      </AddCityWindow>\r\n    </>\r\n  );\r\n};\r\n","import { AppState } from \"app/types/AppState\";\r\n\r\nconst getCitiesSlice = (state: AppState) => state.cities;\r\n\r\nexport const getCitiesIds = (state: AppState) =>\r\n  Object.keys(getCitiesSlice(state));\r\n\r\nexport const getCityById = (state: AppState, cityId: string) =>\r\n  getCitiesSlice(state)[cityId];\r\n","import {\r\n  Card,\r\n  CardContent,\r\n  CardHeader,\r\n  Grid,\r\n  IconButton,\r\n  makeStyles,\r\n} from \"@material-ui/core\";\r\nimport { getCityById } from \"app/selectors/cities\";\r\nimport { AppState } from \"app/types/AppState\";\r\nimport { City } from \"app/types/City\";\r\nimport React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport DeleteIcon from \"@material-ui/icons/Delete\";\r\nimport { deleteCity } from \"app/actions/cities\";\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  current: {\r\n    textAlign: \"center\",\r\n    fontSize: \"2em\",\r\n    marginBottom: theme.spacing(1),\r\n  },\r\n}));\r\n\r\ninterface Props {\r\n  id: string;\r\n  city: City;\r\n  deleteCity: typeof deleteCity;\r\n}\r\n\r\nconst CityCard = ({ city, deleteCity }: Props) => {\r\n  const classes = useStyles();\r\n\r\n  const handleDelete = () => deleteCity(city.id);\r\n\r\n  return (\r\n    <Card>\r\n      <CardHeader\r\n        title={city.name}\r\n        action={\r\n          <IconButton aria-label=\"delete-city\" onClick={handleDelete}>\r\n            <DeleteIcon />\r\n          </IconButton>\r\n        }\r\n      />\r\n      <CardContent>\r\n        {city.currentWeather ? (\r\n          <div>\r\n            <div className={classes.current}>\r\n              {city.currentWeather?.temperature}\r\n            </div>\r\n            <Grid container spacing={2} justify=\"center\">\r\n              {city.forecast?.slice(1, 6).map((f, i) => (\r\n                <Grid item>\r\n                  <div>Today</div>\r\n                  <div>{f.temperature}</div>\r\n                </Grid>\r\n              ))}\r\n            </Grid>\r\n          </div>\r\n        ) : (\r\n          \"Loading\"\r\n        )}\r\n      </CardContent>\r\n    </Card>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state: AppState, { id }: { id: string }) => ({\r\n  city: getCityById(state, id),\r\n});\r\n\r\nconst mapDispatchToProps = {\r\n  deleteCity,\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CityCard);\r\n","import { Box, Grid } from \"@material-ui/core\";\r\nimport { getCitiesIds } from \"app/selectors/cities\";\r\nimport { AppState } from \"app/types/AppState\";\r\nimport React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport CityCard from \"./CityCard\";\r\n\r\ninterface Props {\r\n  citiesIds: ReturnType<typeof getCitiesIds>;\r\n}\r\n\r\nexport const Main = ({ citiesIds }: Props) => {\r\n  return (\r\n    <Box m={4}>\r\n      <Grid container spacing={2}>\r\n        {citiesIds.map((cityId) => (\r\n          <Grid item key={cityId} xs={12} md={4}>\r\n            <CityCard id={cityId} />\r\n          </Grid>\r\n        ))}\r\n      </Grid>\r\n    </Box>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state: AppState) => ({\r\n  citiesIds: getCitiesIds(state),\r\n});\r\n\r\nexport default connect(mapStateToProps)(Main);\r\n","import { CREATE_TOAST, DELETE_LAST_TOAST } from \"app/constants/actions\";\r\nimport { Toast } from \"app/types/Toast\";\r\n\r\ninterface CreateToast {\r\n  type: typeof CREATE_TOAST;\r\n  toast: Toast;\r\n}\r\n\r\nexport const createToast = (message: string, timeout = 2000): CreateToast => ({\r\n  type: CREATE_TOAST,\r\n  toast: { message, timeout },\r\n});\r\n\r\ninterface DeleteLastToast {\r\n  type: typeof DELETE_LAST_TOAST;\r\n}\r\n\r\nexport const deleteLastToast = (): DeleteLastToast => ({\r\n  type: DELETE_LAST_TOAST,\r\n});\r\n\r\nexport type ToastActions = CreateToast | DeleteLastToast;\r\n","import { AppState } from \"app/types/AppState\";\r\nimport { Toast } from \"app/types/Toast\";\r\n\r\nconst getToastsSlice = (state: AppState) => state.toasts;\r\n\r\nexport const getToastMessage = (state: AppState): Toast | null => {\r\n  const toasts = getToastsSlice(state);\r\n  if (toasts.length) {\r\n    return toasts[0];\r\n  }\r\n  return null;\r\n};\r\n","import { Snackbar } from \"@material-ui/core\";\r\nimport { deleteLastToast } from \"app/actions/toasts\";\r\nimport { getToastMessage } from \"app/selectors/toasts\";\r\nimport { AppState } from \"app/types/AppState\";\r\nimport { Toast } from \"app/types/Toast\";\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\ninterface Props {\r\n  toast: Toast | null;\r\n  deleteLastToast: typeof deleteLastToast;\r\n}\r\n\r\nconst Toaster = ({ toast, deleteLastToast }: Props) => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n\r\n  const handleClose = () => {\r\n    setIsOpen(false);\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (toast !== null) {\r\n      setIsOpen(true);\r\n    } else {\r\n      setIsOpen(false);\r\n    }\r\n  }, [toast]);\r\n\r\n  return (\r\n    <Snackbar\r\n      message={toast?.message}\r\n      open={isOpen}\r\n      onClose={handleClose}\r\n      anchorOrigin={{ vertical: \"bottom\", horizontal: \"left\" }}\r\n      autoHideDuration={toast?.timeout}\r\n      onExited={() => deleteLastToast()}\r\n    />\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state: AppState) => ({\r\n  toast: getToastMessage(state),\r\n});\r\n\r\nconst mapDispatchToProps = {\r\n  deleteLastToast,\r\n};\r\nexport default connect(mapStateToProps, mapDispatchToProps)(Toaster);\r\n","import React, { useEffect } from \"react\";\r\nimport Header from \"components/Header\";\r\nimport { AddCity } from \"components/AddCity\";\r\nimport Main from \"components/Main\";\r\nimport { initApp } from \"app/actions/initApp\";\r\nimport { connect } from \"react-redux\";\r\nimport Toaster from \"components/Toaster\";\r\n\r\ninterface Props {\r\n  initApp: typeof initApp;\r\n}\r\n\r\nfunction App({ initApp }: Props) {\r\n  useEffect(() => {\r\n    initApp();\r\n  }, [initApp]);\r\n\r\n  return (\r\n    <div>\r\n      <Header />\r\n      <Main />\r\n      <AddCity />\r\n      <Toaster />\r\n    </div>\r\n  );\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n  initApp,\r\n};\r\n\r\nexport default connect(undefined, mapDispatchToProps)(App);\r\n","import { INIT_APP } from \"app/constants/actions\";\r\n\r\nexport interface InitApp {\r\n  type: typeof INIT_APP;\r\n}\r\n\r\nexport const initApp = (): InitApp => ({\r\n  type: INIT_APP,\r\n});\r\n","import {\r\n  ADD_CITY,\r\n  DELETE_CITY,\r\n  SET_CURRENT_WEATHER,\r\n} from \"app/constants/actions\";\r\nimport { AppAction } from \"app/types/AppAction\";\r\nimport { City } from \"app/types/City\";\r\n\r\ninterface CitiesState {\r\n  [prop: string]: City;\r\n}\r\n\r\nconst initialState: CitiesState = {};\r\n\r\nexport const citiesReducer = (\r\n  state = initialState,\r\n  action: AppAction\r\n): CitiesState => {\r\n  switch (action.type) {\r\n    case ADD_CITY: {\r\n      const city = action.city;\r\n      return { ...state, [city.id]: city };\r\n    }\r\n\r\n    case SET_CURRENT_WEATHER: {\r\n      const { cityId, weather, forecast } = action.payload;\r\n      return {\r\n        ...state,\r\n        [cityId]: { ...state[cityId], currentWeather: weather, forecast },\r\n      };\r\n    }\r\n\r\n    case DELETE_CITY: {\r\n      const cityId = action.cityId;\r\n      const newState = { ...state };\r\n      delete newState[cityId];\r\n      return newState;\r\n    }\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { CREATE_TOAST, DELETE_LAST_TOAST } from \"app/constants/actions\";\r\nimport { AppAction } from \"app/types/AppAction\";\r\nimport { Toast } from \"app/types/Toast\";\r\n\r\ntype ToasterState = Toast[];\r\n\r\nconst initialState: ToasterState = [] as Toast[];\r\n\r\nexport const toasterReducer = (\r\n  state = initialState,\r\n  action: AppAction\r\n): ToasterState => {\r\n  switch (action.type) {\r\n    case CREATE_TOAST:\r\n      return [...state, action.toast];\r\n\r\n    case DELETE_LAST_TOAST:\r\n      return state.slice(1);\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { API_START, API_END } from \"app/constants/actions\";\r\nimport { AppAction } from \"app/types/AppAction\";\r\n\r\ninterface UiState {\r\n  requests: number;\r\n}\r\n\r\nconst initialState: UiState = {\r\n  requests: 0,\r\n};\r\n\r\nexport const uiReducer = (state = initialState, action: AppAction): UiState => {\r\n  switch (action.type) {\r\n    case API_START:\r\n      return { ...state, requests: state.requests + 1 };\r\n\r\n    case API_END:\r\n      return { ...state, requests: state.requests - 1 };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { combineReducers } from \"redux\";\r\nimport { citiesReducer } from \"./cities\";\r\nimport { toasterReducer } from \"./toaster\";\r\nimport { uiReducer } from \"./ui\";\r\n\r\nexport const rootReducer = combineReducers({\r\n  cities: citiesReducer,\r\n  ui: uiReducer,\r\n  toasts: toasterReducer,\r\n});\r\n","import { API_END, API_START } from \"app/constants/actions\";\r\nimport { AppAction, ActionConstant } from \"app/types/AppAction\";\r\n\r\ntype method = \"GET\" | \"POST\";\r\n\r\nexport interface ActionWithDataPayload {\r\n  type: ActionConstant;\r\n  payload: {\r\n    data?: any;\r\n  };\r\n}\r\n\r\nexport interface ApiStart {\r\n  type: typeof API_START;\r\n  payload: {\r\n    url: string;\r\n    method: method;\r\n    data?: {};\r\n    pending: AppAction;\r\n    success: ActionWithDataPayload;\r\n    error: ActionWithDataPayload;\r\n  };\r\n}\r\n\r\nconst get: (\r\n  url: string,\r\n  pending: AppAction,\r\n  success: ActionWithDataPayload,\r\n  error: ActionWithDataPayload\r\n) => ApiStart = (url, pending, success, error) => ({\r\n  type: API_START,\r\n  payload: { url, method: \"GET\", pending, success, error },\r\n});\r\n\r\nexport const api = {\r\n  get,\r\n};\r\n\r\nexport interface ApiEnd {\r\n  type: typeof API_END;\r\n}\r\n\r\nexport const apiEnd = (): ApiEnd => ({ type: API_END });\r\n\r\nexport type ApiActions = ApiStart | ApiEnd;\r\n","import { MULTI } from \"app/constants/actions\";\r\nimport { AppAction } from \"app/types/AppAction\";\r\n\r\nexport interface Multi {\r\n  type: typeof MULTI;\r\n  actions: AppAction[];\r\n}\r\n\r\nexport const multi = (actions: AppAction[]): Multi => ({\r\n  type: MULTI,\r\n  actions,\r\n});\r\n","import { fetchWeatherMdl } from \"./app/fetchWeather\";\r\nimport { apiMdl } from \"./core/api\";\r\nimport { multiMdl } from \"./core/multi\";\r\nimport { updateWeatherMdl } from \"./app/updateWeather\";\r\nimport { initAppMdl } from \"./app/initApp\";\r\nimport { limitNumberOfCitiesMdl } from \"./app/limitNumberOfCities\";\r\nimport { persistanceMdl } from \"./app/persistance\";\r\n\r\nexport const middleware = [\r\n  multiMdl,\r\n  apiMdl,\r\n  initAppMdl,\r\n  limitNumberOfCitiesMdl,\r\n  persistanceMdl,\r\n  fetchWeatherMdl,\r\n  updateWeatherMdl,\r\n];\r\n","import { MULTI } from \"app/constants/actions\";\r\nimport { Middleware } from \"../Middleware\";\r\n\r\nexport const multiMdl: Middleware = ({ dispatch }) => (next) => (action) => {\r\n  next(action);\r\n  if (action.type === MULTI) {\r\n    action.actions.forEach((a) => dispatch(a));\r\n  }\r\n};\r\n","import { API_START } from \"app/constants/actions\";\r\nimport { Middleware } from \"../Middleware\";\r\nimport { API_URL } from \"app/constants/urls\";\r\nimport { AppAction } from \"app/types/AppAction\";\r\nimport { apiEnd } from \"app/actions/api\";\r\n\r\nexport const apiMdl: Middleware = ({ dispatch }) => (next) => (action) => {\r\n  next(action);\r\n\r\n  if (action.type === API_START) {\r\n    const { method, pending, success, error, data, url } = action.payload;\r\n    const payload = action.payload;\r\n    const options = {\r\n      method,\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(data) || undefined,\r\n    };\r\n\r\n    dispatch(pending);\r\n    fetch(\r\n      encodeURI(\r\n        API_URL + url + \"&units=metric&appid=5d2145b1e3153ce2a87bbad571a98ba4\"\r\n      ),\r\n      options\r\n    )\r\n      .then((response) => response.json())\r\n      .then((data) => {\r\n        payload.success.payload.data = data;\r\n        dispatch(success as AppAction);\r\n      })\r\n      .catch((err) => {\r\n        error.payload.data = err;\r\n        dispatch(error as AppAction);\r\n      })\r\n      .then(() => dispatch(apiEnd()));\r\n  }\r\n};\r\n","export const API_URL =\r\n  \"https://cors-anywhere.herokuapp.com/http://api.openweathermap.org/data/2.5\";\r\n","import { addCity } from \"app/actions/cities\";\r\nimport { createToast } from \"app/actions/toasts\";\r\nimport { INIT_APP } from \"app/constants/actions\";\r\nimport { Middleware } from \"../Middleware\";\r\n\r\nexport const initAppMdl: Middleware = ({ dispatch }) => (next) => (action) => {\r\n  next(action);\r\n\r\n  if (action.type === INIT_APP) {\r\n    navigator.geolocation.getCurrentPosition(\r\n      (position) => {\r\n        const { latitude, longitude } = position.coords;\r\n        dispatch(addCity(\"Current\", latitude, longitude));\r\n      },\r\n      () => {\r\n        dispatch(createToast(\"Could not access current location\"));\r\n      }\r\n    );\r\n  }\r\n};\r\n","import { createToast } from \"app/actions/toasts\";\r\nimport { ADD_CITY } from \"app/constants/actions\";\r\nimport { getCitiesIds } from \"app/selectors/cities\";\r\nimport { Middleware } from \"../Middleware\";\r\n\r\nexport const limitNumberOfCitiesMdl: Middleware = ({ dispatch, getState }) => (\r\n  next\r\n) => (action) => {\r\n  const maxNumberOfCities = 6;\r\n\r\n  if (action.type === ADD_CITY) {\r\n    const numberOfCities = getCitiesIds(getState()).length;\r\n    if (numberOfCities === maxNumberOfCities) {\r\n      dispatch(createToast(\"Only 6 cities allowed\"));\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  next(action);\r\n};\r\n","import { addCity } from \"app/actions/cities\";\r\nimport { multi } from \"app/actions/multi\";\r\nimport { ADD_CITY, INIT_APP } from \"app/constants/actions\";\r\nimport { City } from \"app/types/City\";\r\nimport { Middleware } from \"../Middleware\";\r\n\r\nexport const persistanceMdl: Middleware = ({ dispatch, getState }) => (\r\n  next\r\n) => (action) => {\r\n  next(action);\r\n\r\n  if (action.type === INIT_APP) {\r\n    const cities = JSON.parse(localStorage.getItem(\"cities\") as string) as\r\n      | City[]\r\n      | null;\r\n    if (cities) {\r\n      dispatch(\r\n        multi(cities.map((city) => addCity(city.name, city.lat, city.lng)))\r\n      );\r\n    }\r\n  }\r\n\r\n  if (action.type === ADD_CITY) {\r\n    const cities = Object.values(getState().cities);\r\n    const persistableCities = cities.filter((city) => city.name !== \"Current\");\r\n    localStorage.setItem(\"cities\", JSON.stringify(persistableCities));\r\n  }\r\n};\r\n","import {\r\n  ADD_CITY,\r\n  FETCH_CURRENT_WEATHER,\r\n  FETCH_CURRENT_WEATHER_SUCCESS,\r\n} from \"app/constants/actions\";\r\nimport { Middleware } from \"../Middleware\";\r\nimport { api } from \"app/actions/api\";\r\nimport {\r\n  fetchCityCurrentWeather,\r\n  fetchCityCurrentWeatherPending,\r\n  fetchCityCurrentWeatherSuccess,\r\n  fetchCityCurrentWeatherError,\r\n  setCityCurrentWeather,\r\n} from \"app/actions/cities\";\r\nimport { Weather } from \"app/types/Weather\";\r\nimport { getCityById } from \"app/selectors/cities\";\r\n\r\nexport const fetchWeatherMdl: Middleware = ({ dispatch, getState }) => (\r\n  next\r\n) => (action) => {\r\n  next(action);\r\n\r\n  if (action.type === ADD_CITY) {\r\n    dispatch(fetchCityCurrentWeather(action.city.id));\r\n  }\r\n\r\n  if (action.type === FETCH_CURRENT_WEATHER) {\r\n    const { cityId } = action;\r\n    const pending = fetchCityCurrentWeatherPending(cityId);\r\n    const success = fetchCityCurrentWeatherSuccess(cityId);\r\n    const error = fetchCityCurrentWeatherError(cityId);\r\n\r\n    const [lat, lon] = cityId.split(\",\");\r\n    dispatch(\r\n      api.get(\r\n        `/onecall?lat=${lat}&lon=${lon}&exclude=minutely,hourly,alerts`,\r\n        pending,\r\n        success,\r\n        error\r\n      )\r\n    );\r\n  }\r\n\r\n  if (action.type === FETCH_CURRENT_WEATHER_SUCCESS) {\r\n    const {\r\n      cityId,\r\n      payload: { data },\r\n    } = action;\r\n    const weather: Weather = { temperature: data!.current.temp };\r\n    const forecast: Weather[] = data!.daily.map((f) => ({\r\n      temperature: f.temp.day,\r\n    }));\r\n\r\n    const cityExists = getCityById(getState(), cityId);\r\n    if (cityExists) {\r\n      dispatch(setCityCurrentWeather(cityId, weather, forecast));\r\n    }\r\n  }\r\n};\r\n","import { fetchCityCurrentWeather } from \"app/actions/cities\";\r\nimport { multi } from \"app/actions/multi\";\r\nimport { UPDATE_ALL_WEATHER } from \"app/constants/actions\";\r\nimport { getCitiesIds } from \"app/selectors/cities\";\r\nimport { Middleware } from \"../Middleware\";\r\n\r\nexport const updateWeatherMdl: Middleware = ({ dispatch, getState }) => (\r\n  next\r\n) => (action) => {\r\n  next(action);\r\n\r\n  if (action.type === UPDATE_ALL_WEATHER) {\r\n    dispatch(\r\n      multi(\r\n        getCitiesIds(getState()).map((cityId) =>\r\n          fetchCityCurrentWeather(cityId)\r\n        )\r\n      )\r\n    );\r\n  }\r\n};\r\n","import { createStore, applyMiddleware, compose } from \"redux\";\r\nimport { rootReducer } from \"app/reducers/root\";\r\nimport { middleware } from \"app/middleware\";\r\n\r\ndeclare global {\r\n  interface Window {\r\n    __REDUX_DEVTOOLS_EXTENSION_COMPOSE__: any;\r\n  }\r\n}\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\r\n\r\nexport default createStore(\r\n  rootReducer,\r\n  composeEnhancers(applyMiddleware(...middleware))\r\n);\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\nimport \"fontsource-roboto\";\r\nimport CssBaseline from \"@material-ui/core/CssBaseline\";\r\nimport store from \"./app/store\";\r\nimport { Provider } from \"react-redux\";\r\n\r\nif (process.env.NODE_ENV === \"development\") {\r\n  const { worker } = require(\"./mocks/browser\");\r\n  worker.start();\r\n}\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <CssBaseline />\r\n    <Provider store={store}>\r\n      <App />\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}